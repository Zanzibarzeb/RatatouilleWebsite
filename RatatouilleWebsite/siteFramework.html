<!doctype html>

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Not a recipe</title>
	<link rel="icon" href="./assets/EvenSmallerLogo.png">
	
	<link rel="stylesheet" type="text/css" href="./testRunner.css">
	
	<link rel="stylesheet" type="text/css" href="./sideBarTree.css">
	
	<link rel="stylesheet" type="text/css" href="./videoPlayer.css">
	
	<style type="text/css">
		
		
		.mainGrid {
			display: grid;
			grid-template-rows: 80px 1fr;
			grid-template-columns: 150px 1fr;
		}
				
		.fill-container {
			height: 100%;
			width: 100%;
			object-fit: contain;
/* 
			clip-path: inset(0);
 */
		}
		
		.main-header {
			display: flex;
			align-items: center;
			position: relative;
			height: 100%;
			width: 100%;
			object-fit: contain;
			background-color: red;
		}
		
		.logo {
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			object-fit: contain;
		}
		
		.sidebar-field {
			background-color: #38B9D3;
		}
		
		.course-title {
			text-align: center;
			font-family: Arial, sans-serif;
			font-size: 50px;
		}
		
	</style>
		
</head>

<body onload="initialize();" style="margin:0;">

	<div id="wholeWindow" class="mainGrid">
		<div id='notARecipeLogo' class='fill-container'>
			<image id='logo' class='fill-container'
				src="./assets/Logo.png"/>
		</div>
		
		<div id="header" class='main-header'>
			<p id="courseTitle"
				class = "course-title fill-container">
			</p>
		</div>
		
		<div class='fill-container'
			id='sideBar'
			style='min-width=200; clip-path:inset(0);'>
			<ul id="tableOfContents" class="fill-container sidebar-field"/>
		</div>
	
		<div class='fill-container'
			id='contentArea'
			position='relative'>
		</div>	
	</div>

	<script src="./configReader.js" type="text/javascript">
	</script>
	
	<script src="./sideBarTreeInit.js" type="text/javascript">
	</script>
	
	<script src="./testRunner.js" type="text/javascript">
	</script>
	
	<script src="./videoPlayer.js" type="text/javascript">
	</script>
	
	<script src="./customHTML.js" type="text/javascript">
	</script>
	
  	<script type="text/javascript">
  		"use strict";
  		
  		var videoPlayer;
  		var customController;
  		
  		function nextStage() {
  			stageNumber++;
  			
  			if (stageNumber < courseConfig.stages.length) {
  				// start the next stage
  				playStage();
  				setCurrentItem(stageNumber, 0);
  			}
  		}
   		
  		function setSubStage(substage) {
  			setCurrentItem(stageNumber, substage);
  		}
 		
  		function playSubstage(stage, substage) {
  			console.log('playSubstage');
			var stageConfig = courseConfig.stages[stage];
			
			stageNumber = stage;
			
			if (stageConfig.stageType == 'video') {
				videoPlayer = new videoController(courseConfig, stageNumber);
				videoPlayer.playVideoFromStage(stage,substage);
			} else if (stageConfig.stageType == 'test') {
				initializeTest(courseConfig, stage);
			} else if (stageConfig.stageType == 'html') {
				customController = new customHTMLController(courseConfig, stage);
			}
			
			setSubStage(substage);
  		}
  		
  		function playStage() {
  			playSubstage(stageNumber, 0);
  		}
  		
  		// **** initialization ****
 
		function configReadCallback(courseConfig) {
			console.log("configReadCallback");
			initTOC(courseConfig);
			setCurrentItem(stageNumber, 0);
			
			var titleElement = document.getElementById("courseTitle");
			console.log('titleElement: ' + titleElement)
			console.log('text content: ' + titleElement.innerText);
			titleElement.innerText = courseConfig.title;
			
			videoPlayer = new videoController(courseConfig, stageNumber);
			console.log('********* videoPlayer');
			console.log(videoPlayer);
  			playStage();
		}
					
		function initialize() {
			console.log("initialize");
			readConfigFromQueryString(configReadCallback);
		};
		
	</script>
    
  </body>
  </html>
