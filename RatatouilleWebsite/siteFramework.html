<!doctype html>

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Not a recipe</title>
	<link rel="icon" href="./assets/EvenSmallerLogo.png">
	
	<link rel="stylesheet" type="text/css" href="./testRunner.css">
	
	<link rel="stylesheet" type="text/css" href="./sideBarTree.css">
	
	<link rel="stylesheet" type="text/css" href="./videoPlayer.css">
	
	<style type="text/css">
		
		.header-and-body {
			display: grid;
			grid-template-rows: 80px 1fr;
/* 
			background-color: lightblue;
 */
			width: 100%;
			height: 100vh;
			margin: 50;
		}
		
		.sidebar-and-content {
			display: grid;
			grid-template-columns: minmax(100px, 200px) 1fr;
/* 			background-color: pink; */
		}
		
		.fill-container {
			height:100%;
			width:100%;
			object-fit:contain;
		}
		
		.main-header {
			display: flex;
			position: relative;
			height:100%;
			width:100%;
			object-fit:contain;
		}
		
		.logo {
			position: absolute;
			top: 0;
			left: 0;
			height: 100%;
			object-fit: contain;
		}
		
		.sidebar-field {
			background-color: #38B9D3;
		}
		
		.course-title {
			text-align: center;
			width: 100%;
			font-family: Arial, sans-serif;
			font-size: 50px;
		}
		
	</style>
		
</head>

<body onload="initialize();" style="margin:0;">

	<div id="wholeWindow" class="header-and-body">
		<div id='header' class="main-header">
			<image id='logo' class = 'logo'
				src="./assets/Logo.png"/>
			<p id="courseTitle"></p>
		</div>
		
		<div id='sideBarAndContent' class='sidebar-and-content'>
			<div class='fill-container'
				id='sideBar'
				style='min-width=200; clip-path:inset(0);'>
				<ul id="tableOfContents" class="fill-container sidebar-field"/>
			</div>
		
			<div class='fill-container'
				id='contentArea'
				position='relative'>
			</div>
		</div>
	</div>

	<script src="./configReader.js" type="text/javascript">
	</script>
	
	<script src="./sideBarTreeInit.js" type="text/javascript">
	</script>
	
	<script src="./testRunner.js" type="text/javascript">
	</script>
	
	<script src="./videoPlayer.js" type="text/javascript">
	</script>
	
  	<script type="text/javascript">
  		"use strict";
  		
  		var videoPlayer;
  		
  		function nextStage() {
  			stageNumber++;
  			
  			if (stageNumber < courseConfig.stages.length) {
  				// start the next stage
  				playStage();
  				setCurrentItem(stageNumber, 0);
  			}
  		}
   		
  		function setSubStage(substage) {
  			setCurrentItem(stageNumber, substage);
  		}
 		
  		function playSubstage(stage, substage) {
  			console.log('playSubstage');
			var stageConfig = courseConfig.stages[stage];
			
			stageNumber = stage;
			
			if (stageConfig.stageType == 'video') {
				videoPlayer = new videoController(courseConfig, stageNumber);
				videoPlayer.playVideoFromStage(stage,substage);
			} else if (stageConfig.stageType == 'test') {
				initializeTest(courseConfig, stage);
			}
			
			setSubStage(substage);
  		}
  		
  		function playStage() {
  			playSubstage(stageNumber, 0);
  		}
 
		function configReadCallback(courseConfig) {
			console.log("configReadCallback");
			initTOC(courseConfig);
			setCurrentItem(stageNumber, 0);
			
			var titleElement = document.getElementById("courseTitle");
			titleElement.innerText = courseConfig.title;
			titleElement.classList.add('course-title');
			
			videoPlayer = new videoController(courseConfig, stageNumber);
			console.log('********* videoPlayer');
			console.log(videoPlayer);
  			playStage();
		}
					
		function initialize() {
			console.log("initialize");
			readConfigFromQueryString(configReadCallback);
		};
		
	</script>
    
  </body>
  </html>
