<!doctype html>

<html lang="en">
<head>
	<meta charset="utf-8">

	<title>Not a recipe</title>
	<link rel="icon" href="./assets/EvenSmallerLogo.png">
	
	<script type="text/javascript">
	</script>
	<style type="text/css">
		canvas { border: 1px solid black; }
	</style>
</head>

<body onload="initialize();">

	<div id="contentDiv">
		<video src="./shortTestVideo.m4v"
			id="mainVideoFrame"
			controls="true"
			autoplay = "true"
		  />
	</div>

  <script type="text/javascript">
  	
	var videoList;
	
	
	function readVideoList() {
		var url = "./videoList.json";

		var jsonFile = new XMLHttpRequest();
		jsonFile.open("GET",url,true);
		jsonFile.send();
	
		var jsonVideoList;

		jsonFile.onreadystatechange = function() {
			if (jsonFile.readyState== 4 && jsonFile.status == 200) {
				jsonVideoList = jsonFile.responseText;
				console.log("JSON video list\n");
				console.log(jsonVideoList);
				videoList = JSON.parse(jsonVideoList);
				console.log(videoList);
			}
		}
	}
	


	function onendedHandler(event) {
		console.log("onendedHandler\n");
		videoFrame = document.getElementById("mainVideoFrame");
		videoFrame.setAttribute("src", "moovIT.m4v");
		videoFrame.play();
		
		//window.location = "play2.html"
	};

	function initialize() {
		console.log("initialize");
		
	// 	$.getJSON("videoList.json", function(json) {
//     	console.log(json); // this will show the info it in firebug console
// 		});
// 		
// 		JSON.parse(text);

		// read video list
		readVideoList();
		
		//read REST parameters
		const queryString = window.location.search;
		console.log(queryString);
		const urlParms = new URLSearchParams(queryString);
		const videoFile = urlParms.get("video");
		console.log(videoFile);

	  
	  	// add video ended handler to the video frame
		videoFrame = document.getElementById("mainVideoFrame");
		videoFrame.addEventListener("ended", onendedHandler);
	};
	
	function playVideo() {
		videoElement = document.getElementById("mainVideoFrame");
		videoElement.setAttribute("onended", "onendedHandler");

		videoElement.play();
	};
	
  </script>
    
	<div id="playPauseButtons">
		<button id= "playButton" type="button" onclick="playVideo()">Play</button>
	</div>

  </body>
  </html>
